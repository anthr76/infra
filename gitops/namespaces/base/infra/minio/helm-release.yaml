---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: minio
  namespace: infra
spec:
  interval: 5m
  chart:
    spec:
      chart: minio
      version: 3.1.9
      sourceRef:
        kind: HelmRepository
        name: minio-charts
        namespace: flux-system
      interval: 5m
  values:
    mode: gateway
    existingSecret: "minio"
    gateway:
      replicas: 1
    nodeSelector:
      kubernetes.io/arch: amd64
    persistence:
      enabled: true
      existingClaim: "minio-nfs"
    nameOverride: minio
    environment:
      MINIO_PROMETHEUS_AUTH_TYPE: "public"
      MINIO_UPDATE: "off"
      TZ: "America/New_York"
    securityContext:
      runAsUser: 65534
      runAsGroup: 65534
      fsGroup: 65534
    resources:
      requests:
        memory: 100Mi
        cpu: 100m
      limits:
        memory: 750Mi
