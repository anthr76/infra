---
apiVersion: "acid.zalan.do/v1"
kind: postgresql
metadata:
  name: acid-authelia-cluster
  namespace: networking
spec:
  teamId: "acid"
  volume:
    size: 1Gi
  numberOfInstances: 2
  users:
    postgres:
    - superuser
    - createdb
  databases:
    authelia_internal: postgres
    authelia_external: postgres
  postgresql:
    version: "13"
  resources:
    requests:
      cpu: 100m
      memory: 100Mi
    limits:
      cpu: 500m
      memory: 500Mi
  enableConnectionPooler: true
  patroni:
    pg_hba:
    - local     all  all  trust
    - host      all  all  0.0.0.0/0   md5
    - host      all  all  ::1/128     md5
    - hostssl   all  all  all  md5
    - hostssl   all  +zalandos all        pam
    - hostssl   all  +zalandos 0.0.0.0/0  pam
    - hostssl   all  +zalandos ::1/128    pam
    - hostssl  replication  standby  all md5
    - hostnossl all  all  all  md5
