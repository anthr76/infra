[Unit]
Description=Install k3s
Requires=usr-libexec.mount
ConditionPathExists=!/etc/.k3s-installed
        
[Service]
Type=oneshot
Environment=INSTALL_K3S_BIN_DIR=/opt/bin INSTALL_K3S_SELINUX_WARN=true INSTALL_K3S_CHANNEL=latest
ExecStart=/usr/bin/mkdir -p /opt/bin
ExecStart=/usr/bin/curl -sfSL -o /tmp/k3s.sh https://get.k3s.io
ExecStart=/usr/bin/chmod +x /tmp/k3s.sh
ExecStart=/tmp/k3s.sh
ExecStart=/usr/bin/touch /etc/.k3s-installed
        
[Install]
WantedBy=multi-user.target