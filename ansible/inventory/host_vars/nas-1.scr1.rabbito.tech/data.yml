ansible_python_interpreter: /usr/bin/python3
ansible_user: anthonyjrabbito
zfs_install_update: false
zfs_enable_nfs: true
zfs_manage_filesystem_permissions: true
zfs_enable_samba: false
zfs_enable_performance_tuning: false # Not idempotent
zfs_create_pools: true
zfs_create_filesystems: true
zfs_pools:
  - name: "tank"
    action: "create"
    atime: "on"
    compression: "lz4"
    devices:
      - "/dev/disk/by-id/ata-WDC_WD100EMAZ-00WJTA0_JEJNGLMN"
      - "/dev/disk/by-id/ata-WDC_WD100PURZ-85W86Y0_7PKY328C"
      - "/dev/disk/by-id/ata-WDC_WD100PURZ-85W86Y0_7JKZBJZC"
      - "/dev/disk/by-id/ata-WDC_WD100PURZ-85W86Y0_7JG1MHAC"
    type: "raidz"
    state: "present"
  - name: "tank"
    action: "add"
    compression: "lz4"
    devices:
      - "/dev/disk/by-id/nvme-INTEL_SSDPEKNW010T9_BTNR03240QH11P0B"
    type: "cache"
    state: "present"
zfs_filesystems:
  - name: media
    pool: tank
    sharenfs: "no_subtree_check,all_squash,anonuid=1000,anongid=1000,rw=@192.168.4.0/24,rw=@192.168.8.0/24,rw=@192.168.9.0/24,rw=@192.168.6.0/24"
    state: present
    owner: 1000
    group: 1000
    mountpoint: "/tank/media"
  - name: frigate
    pool: tank
    sharenfs: "no_subtree_check,all_squash,anonuid=1000,anongid=1000,rw=@192.168.4.0/24,rw=@192.168.8.0/24"
    state: present
    owner: 1000
    group: 1000
    mountpoint: "/tank/frigate"
  - name: persistentVolumeClaims
    pool: tank
    sharenfs: "no_subtree_check,all_squash,anonuid=1002,anongid=1000,rw=@192.168.8.0/24"
    state: present
    owner: utils
    group: anthonyjrabbito
    mountpoint: "/tank/persistentVolumeClaims"
  - name: persistentVolumeClaims-p
    pool: tank
    state: present
    owner: utils
    group: anthonyjrabbito
    mountpoint: "/tank/persistentVolumeClaims/p"
  - name: persistentVolumeClaims-s
    pool: tank
    state: present
    owner: utils
    group: anthonyjrabbito
    mountpoint: "/tank/persistentVolumeClaims/s"
  - name: minio
    pool: tank
    sharenfs: "no_subtree_check,all_squash,anonuid=65534,anongid=65534,rw=@192.168.4.0/24,rw=@192.168.8.0/24,ro=192.168.9.0/24"
    state: present
    owner: "65534"
    group: "65534"
    mountpoint: "/tank/minio"
  - name: system
    pool: tank
    state: present
    owner: root
    group: root
    mountpoint: "/tank/system"
  - name: system_share
    pool: tank
    sharenfs: "no_subtree_check,all_squash,anonuid=65534,anongid=65534,rw=@192.168.4.0/24,rw=@10.20.99.0/24,rw=@192.168.8.0/24,rw=@192.168.9.0/24"
    state: present
    owner: nobody
    group: nogroup
    mountpoint: "/tank/system_share"
  - name: Rabbito-Scratch
    pool: tank
    sharenfs: "no_subtree_check,all_squash,anonuid=65534,anongid=65534,rw=@192.168.4.0/24,rw=@192.168.6.0/24,rw=@192.168.9.0/24"
    state: present
    mountpoint: "/tank/Rabbito-Scratch"
    owner: nobody
    group: nogroup
zfs_enable_monitoring: true
zfs_monitoring_capacity_threshold: 80
zfs_monitoring_scrub_max_age: 8
zfs_pools_scrub_cron:
  minute: 0
  hour: 0
  day: "*"
  month: "*"
  weekday: sun
apt_remove_packages:
  - apport
  - byobu
  - friendly-recovery
  - landscape-common
  - ntfs-3g
  - popularity-contest
  - snapd
  - sosreport
  - ubuntu-advantage-tools
  - ufw
apt_install_packages:
  - podman
  - targetcli-fb
  - cockpit
  - cockpit-podman
  - cockpit-machines
  - zfsutils-linux
  - smartmontools
  - nvme-cli
  - neovim
  - nfs-kernel-server
