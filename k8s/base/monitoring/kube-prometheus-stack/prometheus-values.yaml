prometheus:
  thanosService:
    enabled: true
  thanosServiceMonitor:
    enabled: true
  thanosIngress:
    enabled: true
    pathType: Prefix
    ingressClassName: "nginx"
    annotations:
      nginx.ingress.kubernetes.io/ssl-redirect: "true"
      nginx.ingress.kubernetes.io/backend-protocol: "GRPC"
      cert-manager.io/cluster-issuer: letsencrypt-production
    hosts:
      - &host "thanos-sidecar.${GENERIC_CLUSTER_INGRESS}"
    tls:
      - hosts:
          - *host
  ingress:
    enabled: true
    ingressClassName: nginx
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-production
    hosts:
      - "prom.${GENERIC_CLUSTER_INGRESS}"
    tls:
      - secretName: prometheus-tls
        hosts:
          - "prom.${GENERIC_CLUSTER_INGRESS}"
  prometheusSpec:
    replicas: 3
    replicaExternalLabelName: "__replica__"
    externalLabels:
      cluster: scr1-cluster-0
    podAntiAffinity: hard
    retentionSize: "6GB"
    ruleSelectorNilUsesHelmValues: false
    serviceMonitorSelectorNilUsesHelmValues: false
    podMonitorSelectorNilUsesHelmValues: false
    probeSelectorNilUsesHelmValues: false
    retention: 2d
    enableAdminAPI: true
    walCompression: true
    storageSpec:
      volumeClaimTemplate:
        spec:
          storageClassName: "ceph-block"
          resources:
            requests:
              storage: 10Gi
    thanos:
      image: quay.io/thanos/thanos:v0.26.0
      # renovate: datasource=docker depName=quay.io/thanos/thanos
      version: "v0.26.0"
      objectStorageConfig:
        name: thanos-objstore-secret
        key: objstore.yml
    additionalScrapeConfigs:
      - job_name: "node-exporter"
        honor_timestamps: true
        static_configs:
          - targets:
              - fw-1.${INT_DOMAIN}:9100
              - ceph-01.${INT_DOMAIN}:9100
              - ceph-02.${INT_DOMAIN}:9100
              - ceph-03.${INT_DOMAIN}:9100
      - job_name: "vyos-coredns"
        static_configs:
          - targets:
              - 10.5.0.7:9153
              - 10.5.0.8:9153
